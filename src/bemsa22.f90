module bemsa22
  implicit none

contains
  function emsav22(x,c) result(v)
    real,dimension(1:6)::x
    real,dimension(1:174)::p
    real,dimension(1:174)::c
    real::v
    
    call bemsav22(x,p)
    v = dot_product(p,c)
    
    return
  end function emsav22
  
  subroutine bemsav22(x,p)
    real,dimension(1:6)::x
    real,dimension(1:17)::m
    real,dimension(1:174)::p
    real,dimension(1:41)::q
    ! ::::::::::::::::::::
    
    call evmono22(x,m)
    call evpoly22(m,q,p)
    
    return
  end subroutine bemsav22
  
  subroutine evmono22(x,m)
    real,dimension(1:6)::x
    real,dimension(1:17)::m
    !::::::::::::::::::::
  
    m(1) = x(6)
    m(2) = x(5)
    m(3) = x(4)
    m(4) = x(3)
    m(5) = x(2)
    m(6) = x(1)
    m(7) = m(3)*m(4)
    m(8) = m(2)*m(5)
    m(9) = m(2)*m(4)
    m(10) = m(3)*m(5)
    m(11) = m(2)*m(3)
    m(12) = m(4)*m(5)
    m(13) = m(2)*m(7)
    m(14) = m(2)*m(10)
    m(15) = m(2)*m(12)
    m(16) = m(3)*m(12)
    m(17) = m(2)*m(16)

    return
  end subroutine evmono22

  subroutine evpoly22(m,q,p)
    real,dimension(1:17)::m
    real,dimension(1:174)::p
    real,dimension(1:41)::q
    !::::::::::::::::::::

    q(1) = m(1)
    q(2) = m(2) + m(3) + m(4) + m(5)
    q(3) = m(6)
    q(4) = m(7) + m(8)
    q(5) = m(9) + m(10)
    q(6) = m(11) + m(12)
    q(7) = q(3)*q(2)
    q(8) = q(2)*q(2) - q(6) - q(5) - q(4) - q(6) - q(5) - q(4)
    p(1) = q(1)*q(4)
    p(2) = q(1)*q(5)
    p(3) = m(13) + m(14) + m(15) + m(16)
    p(4) = q(1)*q(7)
    p(5) = q(3)*q(4)
    q(9) = q(3)*q(5)
    p(6) = q(3)*q(6)
    q(10) = q(2)*q(4) - p(3)
    q(11) = q(2)*q(5) - p(3)
    q(12) = q(2)*q(6) - p(3)
    q(13) = q(3)*q(8)
    q(14) = q(3)*q(7)
    q(15) = q(2)*q(8) - q(12) - q(11) - q(10)
    p(7) = q(1)*p(3)
    p(8) = m(17)
    p(9) = q(1)*p(5)
    p(10) = q(1)*q(9)
    p(11) = q(1)*p(6)
    p(12) = q(3)*p(3)
    p(13) = q(1)*p(1)
    p(14) = q(1)*p(2)
    p(15) = q(1)*q(10)
    p(16) = q(1)*q(11)
    p(17) = q(4)*q(5)
    p(18) = q(4)*q(6)
    p(19) = q(5)*q(6)
    p(20) = q(1)*p(4)
    p(21) = q(1)*q(13)
    p(22) = q(3)*q(10)
    q(16) = q(3)*q(11)
    p(23) = q(3)*q(12)
    p(24) = q(1)*q(14)
    p(25) = q(3)*p(5)
    q(17) = q(3)*q(9)
    p(26) = q(3)*p(6)
    q(18) = q(4)*q(4) - p(8) - p(8)
    q(19) = q(5)*q(5) - p(8) - p(8)
    q(20) = q(6)*q(6) - p(8) - p(8)
    q(21) = q(4)*q(8) - p(19)
    q(22) = q(5)*q(8) - p(18)
    q(23) = q(6)*q(8) - p(17)
    q(24) = q(3)*q(15)
    q(25) = q(3)*q(13)
    q(26) = q(3)*q(14)
    q(27) = q(2)*q(15) - q(23) - q(22) - q(21)
    p(27) = q(1)*p(8)
    p(28) = q(1)*p(12)
    p(29) = q(3)*p(8)
    p(30) = q(1)*p(7)
    p(31) = q(1)*p(17)
    p(32) = q(1)*p(18)
    p(33) = q(1)*p(19)
    p(34) = p(8)*q(2)
    p(35) = q(1)*p(9)
    p(36) = q(1)*p(10)
    p(37) = q(1)*p(11)
    p(38) = q(1)*p(22)
    p(39) = q(1)*q(16)
    p(40) = q(3)*p(17)
    p(41) = q(1)*p(23)
    p(42) = q(3)*p(18)
    p(43) = q(3)*p(19)
    p(44) = q(1)*p(25)
    p(45) = q(1)*q(17)
    p(46) = q(1)*p(26)
    p(47) = q(3)*p(12)
    p(48) = q(1)*p(13)
    p(49) = q(1)*p(14)
    p(50) = q(1)*p(15)
    p(51) = q(1)*q(18)
    p(52) = q(1)*p(16)
    p(53) = q(1)*q(19)
    p(54) = q(4)*p(3) - p(34)
    p(55) = q(5)*p(3) - p(34)
    p(56) = q(6)*p(3) - p(34)
    p(57) = q(1)*q(21)
    p(58) = q(1)*q(22)
    p(59) = q(4)*q(11) - p(55)
    p(60) = q(4)*q(12) - p(56)
    p(61) = q(5)*q(12) - p(56)
    p(62) = q(1)*p(20)
    p(63) = q(1)*p(21)
    p(64) = q(3)*q(18)
    q(28) = q(3)*q(19)
    p(65) = q(3)*q(20)
    p(66) = q(1)*q(24)
    p(67) = q(3)*q(21)
    q(29) = q(3)*q(22)
    p(68) = q(3)*q(23)
    p(69) = q(1)*p(24)
    p(70) = q(1)*q(25)
    p(71) = q(3)*p(22)
    q(30) = q(3)*q(16)
    p(72) = q(3)*p(23)
    p(73) = q(1)*q(26)
    p(74) = q(3)*p(25)
    q(31) = q(3)*q(17)
    p(75) = q(3)*p(26)
    q(32) = q(2)*q(18) - p(54)
    q(33) = q(2)*q(19) - p(55)
    q(34) = q(2)*q(20) - p(56)
    q(35) = q(4)*q(15) - p(61)
    q(36) = q(5)*q(15) - p(60)
    q(37) = q(6)*q(15) - p(59)
    q(38) = q(3)*q(27)
    q(39) = q(3)*q(24)
    q(40) = q(3)*q(25)
    q(41) = q(3)*q(26)
    p(76) = q(1)*p(29)
    p(77) = q(1)*p(27)
    p(78) = q(1)*p(34)
    p(79) = q(1)*p(28)
    p(80) = q(1)*p(40)
    p(81) = q(1)*p(42)
    p(82) = q(1)*p(43)
    p(83) = q(3)*p(34)
    p(84) = q(1)*p(47)
    p(85) = q(3)*p(29)
    p(86) = q(1)*p(30)
    p(87) = q(1)*p(31)
    p(88) = q(1)*p(32)
    p(89) = q(1)*p(54)
    p(90) = q(1)*p(33)
    p(91) = p(8)*q(4)
    p(92) = q(1)*p(55)
    p(93) = p(8)*q(5)
    p(94) = q(1)*p(56)
    p(95) = p(8)*q(6)
    p(96) = q(1)*p(59)
    p(97) = q(1)*p(60)
    p(98) = q(1)*p(61)
    p(99) = p(8)*q(8)
    p(100) = q(1)*p(35)
    p(101) = q(1)*p(36)
    p(102) = q(1)*p(37)
    p(103) = q(1)*p(38)
    p(104) = q(1)*p(64)
    p(105) = q(1)*p(39)
    p(106) = q(1)*q(28)
    p(107) = q(1)*p(41)
    p(108) = q(3)*p(54)
    p(109) = q(3)*p(55)
    p(110) = q(1)*p(65)
    p(111) = q(3)*p(56)
    p(112) = q(1)*p(67)
    p(113) = q(1)*q(29)
    p(114) = q(3)*p(59)
    p(115) = q(1)*p(68)
    p(116) = q(3)*p(60)
    p(117) = q(3)*p(61)
    p(118) = q(1)*p(44)
    p(119) = q(1)*p(45)
    p(120) = q(1)*p(46)
    p(121) = q(1)*p(71)
    p(122) = q(1)*q(30)
    p(123) = q(3)*p(40)
    p(124) = q(1)*p(72)
    p(125) = q(3)*p(42)
    p(126) = q(3)*p(43)
    p(127) = q(1)*p(74)
    p(128) = q(1)*q(31)
    p(129) = q(1)*p(75)
    p(130) = q(3)*p(47)
    p(131) = q(1)*p(48)
    p(132) = q(1)*p(49)
    p(133) = q(1)*p(50)
    p(134) = q(1)*p(51)
    p(135) = q(1)*p(52)
    p(136) = q(1)*p(53)
    p(137) = q(4)*p(19) - p(99)
    p(138) = q(1)*p(57)
    p(139) = q(1)*q(32)
    p(140) = q(1)*p(58)
    p(141) = q(5)*q(18)
    p(142) = q(1)*q(33)
    p(143) = q(4)*q(19)
    p(144) = q(6)*q(18)
    p(145) = q(6)*q(19)
    p(146) = q(4)*q(20)
    p(147) = q(5)*q(20)
    p(148) = q(1)*q(35)
    p(149) = q(1)*q(36)
    p(150) = q(4)*q(22) - p(145)
    p(151) = q(4)*q(23) - p(147)
    p(152) = q(5)*q(23) - p(146)
    p(153) = q(1)*p(62)
    p(154) = q(1)*p(63)
    p(155) = q(1)*p(66)
    p(156) = q(3)*q(32)
    p(157) = q(3)*q(34)
    p(158) = q(1)*q(38)
    p(159) = q(3)*q(35)
    p(160) = q(3)*q(37)
    p(161) = q(1)*p(69)
    p(162) = q(1)*p(70)
    p(163) = q(3)*p(64)
    p(164) = q(3)*p(65)
    p(165) = q(1)*q(39)
    p(166) = q(3)*p(67)
    p(167) = q(3)*p(68)
    p(168) = q(1)*p(73)
    p(169) = q(1)*q(40)
    p(170) = q(3)*p(71)
    p(171) = q(3)*p(72)
    p(172) = q(1)*q(41)
    p(173) = q(3)*p(74)
    p(174) = q(3)*p(75)

    return
  end subroutine evpoly22

  subroutine devmono22(dm,m,flag,xyz,a,r)
    real,dimension(1:17)::dm
    real,dimension(1:17)::m
    real::xyz(4,3),a,r(4,4)
    integer::flag
    !::::::::::::::::::::

    dm(1) =  - m(1)/a*drdx22(flag,6,xyz,r)
    dm(2) =  - m(2)/a*drdx22(flag,5,xyz,r)
    dm(3) =  - m(3)/a*drdx22(flag,4,xyz,r)
    dm(4) =  - m(4)/a*drdx22(flag,3,xyz,r)
    dm(5) =  - m(5)/a*drdx22(flag,2,xyz,r)
    dm(6) =  - m(6)/a*drdx22(flag,1,xyz,r)
    dm(7) = dm(3)*m(4) + m(3)*dm(4)
    dm(8) = dm(2)*m(5) + m(2)*dm(5)
    dm(9) = dm(2)*m(4) + m(2)*dm(4)
    dm(10) = dm(3)*m(5) + m(3)*dm(5)
    dm(11) = dm(2)*m(3) + m(2)*dm(3)
    dm(12) = dm(4)*m(5) + m(4)*dm(5)
    dm(13) = dm(2)*m(7) + m(2)*dm(7)
    dm(14) = dm(2)*m(10) + m(2)*dm(10)
    dm(15) = dm(2)*m(12) + m(2)*dm(12)
    dm(16) = dm(3)*m(12) + m(3)*dm(12)
    dm(17) = dm(2)*m(16) + m(2)*dm(16)

    return
  end subroutine devmono22

  subroutine devpoly22(dm,q,p,dp)
    real,dimension(1:17)::dm
    real,dimension(1:174)::p,dp
    real,dimension(1:41)::q,dq
    !::::::::::::::::::::

    dq(1) = dm(1)
    dq(2) = dm(2) + dm(3) + dm(4) + dm(5)
    dq(3) = dm(6)
    dq(4) = dm(7) + dm(8)
    dq(5) = dm(9) + dm(10)
    dq(6) = dm(11) + dm(12)
    dq(7) = dq(3)*q(2) + q(3)*dq(2)
    dq(8) = dq(2)*q(2) + q(2)*dq(2) - dq(6) - dq(5) - dq(4) - dq(6) -  &
         dq(5) - dq(4)
    dp(1) = dq(1)*q(4) + q(1)*dq(4)
    dp(2) = dq(1)*q(5) + q(1)*dq(5)
    dp(3) = dm(13) + dm(14) + dm(15) + dm(16)
    dp(4) = dq(1)*q(7) + q(1)*dq(7)
    dp(5) = dq(3)*q(4) + q(3)*dq(4)
    dq(9) = dq(3)*q(5) + q(3)*dq(5)
    dp(6) = dq(3)*q(6) + q(3)*dq(6)
    dq(10) = dq(2)*q(4) + q(2)*dq(4) - dp(3)
    dq(11) = dq(2)*q(5) + q(2)*dq(5) - dp(3)
    dq(12) = dq(2)*q(6) + q(2)*dq(6) - dp(3)
    dq(13) = dq(3)*q(8) + q(3)*dq(8)
    dq(14) = dq(3)*q(7) + q(3)*dq(7)
    dq(15) = dq(2)*q(8) + q(2)*dq(8) - dq(12) - dq(11) - dq(10)
    dp(7) = dq(1)*p(3) + q(1)*dp(3)
    dp(8) = dm(17)
    dp(9) = dq(1)*p(5) + q(1)*dp(5)
    dp(10) = dq(1)*q(9) + q(1)*dq(9)
    dp(11) = dq(1)*p(6) + q(1)*dp(6)
    dp(12) = dq(3)*p(3) + q(3)*dp(3)
    dp(13) = dq(1)*p(1) + q(1)*dp(1)
    dp(14) = dq(1)*p(2) + q(1)*dp(2)
    dp(15) = dq(1)*q(10) + q(1)*dq(10)
    dp(16) = dq(1)*q(11) + q(1)*dq(11)
    dp(17) = dq(4)*q(5) + q(4)*dq(5)
    dp(18) = dq(4)*q(6) + q(4)*dq(6)
    dp(19) = dq(5)*q(6) + q(5)*dq(6)
    dp(20) = dq(1)*p(4) + q(1)*dp(4)
    dp(21) = dq(1)*q(13) + q(1)*dq(13)
    dp(22) = dq(3)*q(10) + q(3)*dq(10)
    dq(16) = dq(3)*q(11) + q(3)*dq(11)
    dp(23) = dq(3)*q(12) + q(3)*dq(12)
    dp(24) = dq(1)*q(14) + q(1)*dq(14)
    dp(25) = dq(3)*p(5) + q(3)*dp(5)
    dq(17) = dq(3)*q(9) + q(3)*dq(9)
    dp(26) = dq(3)*p(6) + q(3)*dp(6)
    dq(18) = dq(4)*q(4) + q(4)*dq(4) - dp(8) - dp(8)
    dq(19) = dq(5)*q(5) + q(5)*dq(5) - dp(8) - dp(8)
    dq(20) = dq(6)*q(6) + q(6)*dq(6) - dp(8) - dp(8)
    dq(21) = dq(4)*q(8) + q(4)*dq(8) - dp(19)
    dq(22) = dq(5)*q(8) + q(5)*dq(8) - dp(18)
    dq(23) = dq(6)*q(8) + q(6)*dq(8) - dp(17)
    dq(24) = dq(3)*q(15) + q(3)*dq(15)
    dq(25) = dq(3)*q(13) + q(3)*dq(13)
    dq(26) = dq(3)*q(14) + q(3)*dq(14)
    dq(27) = dq(2)*q(15) + q(2)*dq(15) - dq(23) - dq(22) - dq(21)
    dp(27) = dq(1)*p(8) + q(1)*dp(8)
    dp(28) = dq(1)*p(12) + q(1)*dp(12)
    dp(29) = dq(3)*p(8) + q(3)*dp(8)
    dp(30) = dq(1)*p(7) + q(1)*dp(7)
    dp(31) = dq(1)*p(17) + q(1)*dp(17)
    dp(32) = dq(1)*p(18) + q(1)*dp(18)
    dp(33) = dq(1)*p(19) + q(1)*dp(19)
    dp(34) = dp(8)*q(2) + p(8)*dq(2)
    dp(35) = dq(1)*p(9) + q(1)*dp(9)
    dp(36) = dq(1)*p(10) + q(1)*dp(10)
    dp(37) = dq(1)*p(11) + q(1)*dp(11)
    dp(38) = dq(1)*p(22) + q(1)*dp(22)
    dp(39) = dq(1)*q(16) + q(1)*dq(16)
    dp(40) = dq(3)*p(17) + q(3)*dp(17)
    dp(41) = dq(1)*p(23) + q(1)*dp(23)
    dp(42) = dq(3)*p(18) + q(3)*dp(18)
    dp(43) = dq(3)*p(19) + q(3)*dp(19)
    dp(44) = dq(1)*p(25) + q(1)*dp(25)
    dp(45) = dq(1)*q(17) + q(1)*dq(17)
    dp(46) = dq(1)*p(26) + q(1)*dp(26)
    dp(47) = dq(3)*p(12) + q(3)*dp(12)
    dp(48) = dq(1)*p(13) + q(1)*dp(13)
    dp(49) = dq(1)*p(14) + q(1)*dp(14)
    dp(50) = dq(1)*p(15) + q(1)*dp(15)
    dp(51) = dq(1)*q(18) + q(1)*dq(18)
    dp(52) = dq(1)*p(16) + q(1)*dp(16)
    dp(53) = dq(1)*q(19) + q(1)*dq(19)
    dp(54) = dq(4)*p(3) + q(4)*dp(3) - dp(34)
    dp(55) = dq(5)*p(3) + q(5)*dp(3) - dp(34)
    dp(56) = dq(6)*p(3) + q(6)*dp(3) - dp(34)
    dp(57) = dq(1)*q(21) + q(1)*dq(21)
    dp(58) = dq(1)*q(22) + q(1)*dq(22)
    dp(59) = dq(4)*q(11) + q(4)*dq(11) - dp(55)
    dp(60) = dq(4)*q(12) + q(4)*dq(12) - dp(56)
    dp(61) = dq(5)*q(12) + q(5)*dq(12) - dp(56)
    dp(62) = dq(1)*p(20) + q(1)*dp(20)
    dp(63) = dq(1)*p(21) + q(1)*dp(21)
    dp(64) = dq(3)*q(18) + q(3)*dq(18)
    dq(28) = dq(3)*q(19) + q(3)*dq(19)
    dp(65) = dq(3)*q(20) + q(3)*dq(20)
    dp(66) = dq(1)*q(24) + q(1)*dq(24)
    dp(67) = dq(3)*q(21) + q(3)*dq(21)
    dq(29) = dq(3)*q(22) + q(3)*dq(22)
    dp(68) = dq(3)*q(23) + q(3)*dq(23)
    dp(69) = dq(1)*p(24) + q(1)*dp(24)
    dp(70) = dq(1)*q(25) + q(1)*dq(25)
    dp(71) = dq(3)*p(22) + q(3)*dp(22)
    dq(30) = dq(3)*q(16) + q(3)*dq(16)
    dp(72) = dq(3)*p(23) + q(3)*dp(23)
    dp(73) = dq(1)*q(26) + q(1)*dq(26)
    dp(74) = dq(3)*p(25) + q(3)*dp(25)
    dq(31) = dq(3)*q(17) + q(3)*dq(17)
    dp(75) = dq(3)*p(26) + q(3)*dp(26)
    dq(32) = dq(2)*q(18) + q(2)*dq(18) - dp(54)
    dq(33) = dq(2)*q(19) + q(2)*dq(19) - dp(55)
    dq(34) = dq(2)*q(20) + q(2)*dq(20) - dp(56)
    dq(35) = dq(4)*q(15) + q(4)*dq(15) - dp(61)
    dq(36) = dq(5)*q(15) + q(5)*dq(15) - dp(60)
    dq(37) = dq(6)*q(15) + q(6)*dq(15) - dp(59)
    dq(38) = dq(3)*q(27) + q(3)*dq(27)
    dq(39) = dq(3)*q(24) + q(3)*dq(24)
    dq(40) = dq(3)*q(25) + q(3)*dq(25)
    dq(41) = dq(3)*q(26) + q(3)*dq(26)
    dp(76) = dq(1)*p(29) + q(1)*dp(29)
    dp(77) = dq(1)*p(27) + q(1)*dp(27)
    dp(78) = dq(1)*p(34) + q(1)*dp(34)
    dp(79) = dq(1)*p(28) + q(1)*dp(28)
    dp(80) = dq(1)*p(40) + q(1)*dp(40)
    dp(81) = dq(1)*p(42) + q(1)*dp(42)
    dp(82) = dq(1)*p(43) + q(1)*dp(43)
    dp(83) = dq(3)*p(34) + q(3)*dp(34)
    dp(84) = dq(1)*p(47) + q(1)*dp(47)
    dp(85) = dq(3)*p(29) + q(3)*dp(29)
    dp(86) = dq(1)*p(30) + q(1)*dp(30)
    dp(87) = dq(1)*p(31) + q(1)*dp(31)
    dp(88) = dq(1)*p(32) + q(1)*dp(32)
    dp(89) = dq(1)*p(54) + q(1)*dp(54)
    dp(90) = dq(1)*p(33) + q(1)*dp(33)
    dp(91) = dp(8)*q(4) + p(8)*dq(4)
    dp(92) = dq(1)*p(55) + q(1)*dp(55)
    dp(93) = dp(8)*q(5) + p(8)*dq(5)
    dp(94) = dq(1)*p(56) + q(1)*dp(56)
    dp(95) = dp(8)*q(6) + p(8)*dq(6)
    dp(96) = dq(1)*p(59) + q(1)*dp(59)
    dp(97) = dq(1)*p(60) + q(1)*dp(60)
    dp(98) = dq(1)*p(61) + q(1)*dp(61)
    dp(99) = dp(8)*q(8) + p(8)*dq(8)
    dp(100) = dq(1)*p(35) + q(1)*dp(35)
    dp(101) = dq(1)*p(36) + q(1)*dp(36)
    dp(102) = dq(1)*p(37) + q(1)*dp(37)
    dp(103) = dq(1)*p(38) + q(1)*dp(38)
    dp(104) = dq(1)*p(64) + q(1)*dp(64)
    dp(105) = dq(1)*p(39) + q(1)*dp(39)
    dp(106) = dq(1)*q(28) + q(1)*dq(28)
    dp(107) = dq(1)*p(41) + q(1)*dp(41)
    dp(108) = dq(3)*p(54) + q(3)*dp(54)
    dp(109) = dq(3)*p(55) + q(3)*dp(55)
    dp(110) = dq(1)*p(65) + q(1)*dp(65)
    dp(111) = dq(3)*p(56) + q(3)*dp(56)
    dp(112) = dq(1)*p(67) + q(1)*dp(67)
    dp(113) = dq(1)*q(29) + q(1)*dq(29)
    dp(114) = dq(3)*p(59) + q(3)*dp(59)
    dp(115) = dq(1)*p(68) + q(1)*dp(68)
    dp(116) = dq(3)*p(60) + q(3)*dp(60)
    dp(117) = dq(3)*p(61) + q(3)*dp(61)
    dp(118) = dq(1)*p(44) + q(1)*dp(44)
    dp(119) = dq(1)*p(45) + q(1)*dp(45)
    dp(120) = dq(1)*p(46) + q(1)*dp(46)
    dp(121) = dq(1)*p(71) + q(1)*dp(71)
    dp(122) = dq(1)*q(30) + q(1)*dq(30)
    dp(123) = dq(3)*p(40) + q(3)*dp(40)
    dp(124) = dq(1)*p(72) + q(1)*dp(72)
    dp(125) = dq(3)*p(42) + q(3)*dp(42)
    dp(126) = dq(3)*p(43) + q(3)*dp(43)
    dp(127) = dq(1)*p(74) + q(1)*dp(74)
    dp(128) = dq(1)*q(31) + q(1)*dq(31)
    dp(129) = dq(1)*p(75) + q(1)*dp(75)
    dp(130) = dq(3)*p(47) + q(3)*dp(47)
    dp(131) = dq(1)*p(48) + q(1)*dp(48)
    dp(132) = dq(1)*p(49) + q(1)*dp(49)
    dp(133) = dq(1)*p(50) + q(1)*dp(50)
    dp(134) = dq(1)*p(51) + q(1)*dp(51)
    dp(135) = dq(1)*p(52) + q(1)*dp(52)
    dp(136) = dq(1)*p(53) + q(1)*dp(53)
    dp(137) = dq(4)*p(19) + q(4)*dp(19) - dp(99)
    dp(138) = dq(1)*p(57) + q(1)*dp(57)
    dp(139) = dq(1)*q(32) + q(1)*dq(32)
    dp(140) = dq(1)*p(58) + q(1)*dp(58)
    dp(141) = dq(5)*q(18) + q(5)*dq(18)
    dp(142) = dq(1)*q(33) + q(1)*dq(33)
    dp(143) = dq(4)*q(19) + q(4)*dq(19)
    dp(144) = dq(6)*q(18) + q(6)*dq(18)
    dp(145) = dq(6)*q(19) + q(6)*dq(19)
    dp(146) = dq(4)*q(20) + q(4)*dq(20)
    dp(147) = dq(5)*q(20) + q(5)*dq(20)
    dp(148) = dq(1)*q(35) + q(1)*dq(35)
    dp(149) = dq(1)*q(36) + q(1)*dq(36)
    dp(150) = dq(4)*q(22) + q(4)*dq(22) - dp(145)
    dp(151) = dq(4)*q(23) + q(4)*dq(23) - dp(147)
    dp(152) = dq(5)*q(23) + q(5)*dq(23) - dp(146)
    dp(153) = dq(1)*p(62) + q(1)*dp(62)
    dp(154) = dq(1)*p(63) + q(1)*dp(63)
    dp(155) = dq(1)*p(66) + q(1)*dp(66)
    dp(156) = dq(3)*q(32) + q(3)*dq(32)
    dp(157) = dq(3)*q(34) + q(3)*dq(34)
    dp(158) = dq(1)*q(38) + q(1)*dq(38)
    dp(159) = dq(3)*q(35) + q(3)*dq(35)
    dp(160) = dq(3)*q(37) + q(3)*dq(37)
    dp(161) = dq(1)*p(69) + q(1)*dp(69)
    dp(162) = dq(1)*p(70) + q(1)*dp(70)
    dp(163) = dq(3)*p(64) + q(3)*dp(64)
    dp(164) = dq(3)*p(65) + q(3)*dp(65)
    dp(165) = dq(1)*q(39) + q(1)*dq(39)
    dp(166) = dq(3)*p(67) + q(3)*dp(67)
    dp(167) = dq(3)*p(68) + q(3)*dp(68)
    dp(168) = dq(1)*p(73) + q(1)*dp(73)
    dp(169) = dq(1)*q(40) + q(1)*dq(40)
    dp(170) = dq(3)*p(71) + q(3)*dp(71)
    dp(171) = dq(3)*p(72) + q(3)*dp(72)
    dp(172) = dq(1)*q(41) + q(1)*dq(41)
    dp(173) = dq(3)*p(74) + q(3)*dp(74)
    dp(174) = dq(3)*p(75) + q(3)*dp(75)

    return
  end subroutine devpoly22

  function drdx22(flag,xindex,xyz,r)
    integer i,j,flag,xindex,xyzind,matom,m
    real::xyz(4,3),r(4,4)
    real::drdx22

    if (xindex.eq.1) then 
       i = 1
       j = 2
    elseif (xindex.eq.2) then 
       i = 1
       j = 3
    elseif (xindex.eq.3) then 
       i = 1
       j = 4
    elseif (xindex.eq.4) then 
       i = 2
       j = 3
    elseif (xindex.eq.5) then 
       i = 2
       j = 4
    elseif (xindex.eq.6) then 
       i = 3
       j = 4
    endif

    m=flag
    matom=INT((dble(m)-0.00001d0)/3.d0)+1
    xyzind=MOD(m-1,3)+1

    drdx22 = 0.d0
    if (matom.eq.i.or.matom.eq.j) then
       drdx22=(xyz(i,xyzind)-xyz(j,xyzind))/r(i,j)
       if (matom.eq.j) then
          drdx22 = -drdx22
       endif
    endif

    return
  end function

  subroutine deriv_rev22(c,m,q,p,xyz,a,r,xxp)
    real::c(1:174),m(1:17),p(1:174)
    real::xyz(4,3),r(4,4),a
    !::::::::::::::::::::
    real::pp(1:174),mp(1:17),xxp(1:12)
    real::qp(1:41),q(1:41)

    qp(:)=0.d0
    pp(:)=0.d0
    mp(:)=0.d0
    xxp(:)=0.d0
    pp(174)=c(174)
    pp(173)=c(173)
    pp(172)=c(172)
    pp(171)=c(171)
    pp(170)=c(170)
    pp(169)=c(169)
    pp(168)=c(168)
    pp(167)=c(167)
    pp(166)=c(166)
    pp(165)=c(165)
    pp(164)=c(164)
    pp(163)=c(163)
    pp(162)=c(162)
    pp(161)=c(161)
    pp(160)=c(160)
    pp(159)=c(159)
    pp(158)=c(158)
    pp(157)=c(157)
    pp(156)=c(156)
    pp(155)=c(155)
    pp(154)=c(154)
    pp(153)=c(153)
    pp(152)=c(152)
    pp(151)=c(151)
    pp(150)=c(150)
    pp(149)=c(149)
    pp(148)=c(148)
    pp(147)=c(147)+pp(151)*(-1.d0)
    pp(146)=c(146)+pp(152)*(-1.d0)
    pp(145)=c(145)+pp(150)*(-1.d0)
    pp(144)=c(144)
    pp(143)=c(143)
    pp(142)=c(142)
    pp(141)=c(141)
    pp(140)=c(140)
    pp(139)=c(139)
    pp(138)=c(138)
    pp(137)=c(137)
    pp(136)=c(136)
    pp(135)=c(135)
    pp(134)=c(134)
    pp(133)=c(133)
    pp(132)=c(132)
    pp(131)=c(131)
    pp(130)=c(130)
    pp(129)=c(129)
    pp(128)=c(128)
    pp(127)=c(127)
    pp(126)=c(126)
    pp(125)=c(125)
    pp(124)=c(124)
    pp(123)=c(123)
    pp(122)=c(122)
    pp(121)=c(121)
    pp(120)=c(120)
    pp(119)=c(119)
    pp(118)=c(118)
    pp(117)=c(117)
    pp(116)=c(116)
    pp(115)=c(115)
    pp(114)=c(114)
    pp(113)=c(113)
    pp(112)=c(112)
    pp(111)=c(111)
    pp(110)=c(110)
    pp(109)=c(109)
    pp(108)=c(108)
    pp(107)=c(107)
    pp(106)=c(106)
    pp(105)=c(105)
    pp(104)=c(104)
    pp(103)=c(103)
    pp(102)=c(102)
    pp(101)=c(101)
    pp(100)=c(100)
    pp(99)=c(99)+pp(137)*(-1.d0)
    pp(98)=c(98)
    pp(97)=c(97)
    pp(96)=c(96)
    pp(95)=c(95)
    pp(94)=c(94)
    pp(93)=c(93)
    pp(92)=c(92)
    pp(91)=c(91)
    pp(90)=c(90)
    pp(89)=c(89)
    pp(88)=c(88)
    pp(87)=c(87)
    pp(86)=c(86)
    pp(85)=c(85)
    pp(84)=c(84)
    pp(83)=c(83)
    pp(82)=c(82)
    pp(81)=c(81)
    pp(80)=c(80)
    pp(79)=c(79)
    pp(78)=c(78)
    pp(77)=c(77)
    pp(76)=c(76)
    qp(41)=pp(172)*q(1)
    qp(40)=pp(169)*q(1)
    qp(39)=pp(165)*q(1)
    qp(38)=pp(158)*q(1)
    qp(37)=pp(160)*q(3)
    qp(36)=pp(149)*q(1)
    qp(35)=pp(159)*q(3)+pp(148)*q(1)
    qp(34)=pp(157)*q(3)
    qp(33)=pp(142)*q(1)
    qp(32)=pp(156)*q(3)+pp(139)*q(1)
    pp(75)=c(75)+pp(174)*q(3)+pp(129)*q(1)
    qp(31)=pp(128)*q(1)
    pp(74)=c(74)+pp(173)*q(3)+pp(127)*q(1)
    pp(73)=c(73)+pp(168)*q(1)
    pp(72)=c(72)+pp(171)*q(3)+pp(124)*q(1)
    qp(30)=pp(122)*q(1)
    pp(71)=c(71)+pp(170)*q(3)+pp(121)*q(1)
    pp(70)=c(70)+pp(162)*q(1)
    pp(69)=c(69)+pp(161)*q(1)
    pp(68)=c(68)+pp(167)*q(3)+pp(115)*q(1)
    qp(29)=pp(113)*q(1)
    pp(67)=c(67)+pp(166)*q(3)+pp(112)*q(1)
    pp(66)=c(66)+pp(155)*q(1)
    pp(65)=c(65)+pp(164)*q(3)+pp(110)*q(1)
    qp(28)=pp(106)*q(1)
    pp(64)=c(64)+pp(163)*q(3)+pp(104)*q(1)
    pp(63)=c(63)+pp(154)*q(1)
    pp(62)=c(62)+pp(153)*q(1)
    pp(61)=c(61)+pp(117)*q(3)+pp(98)*q(1)+qp(35)*(-1.d0)
    pp(60)=c(60)+pp(116)*q(3)+pp(97)*q(1)+qp(36)*(-1.d0)
    pp(59)=c(59)+pp(114)*q(3)+pp(96)*q(1)+qp(37)*(-1.d0)
    pp(58)=c(58)+pp(140)*q(1)
    pp(57)=c(57)+pp(138)*q(1)
    pp(56)=c(56)+pp(111)*q(3)+pp(94)*q(1)+qp(34)*(-1.d0)+pp(61)*(-1.d0)+pp(60)*(-1.d0)
    pp(55)=c(55)+pp(109)*q(3)+pp(92)*q(1)+qp(33)*(-1.d0)+pp(59)*(-1.d0)
    pp(54)=c(54)+pp(108)*q(3)+pp(89)*q(1)+qp(32)*(-1.d0)
    pp(53)=c(53)+pp(136)*q(1)
    pp(52)=c(52)+pp(135)*q(1)
    pp(51)=c(51)+pp(134)*q(1)
    pp(50)=c(50)+pp(133)*q(1)
    pp(49)=c(49)+pp(132)*q(1)
    pp(48)=c(48)+pp(131)*q(1)
    pp(47)=c(47)+pp(130)*q(3)+pp(84)*q(1)
    pp(46)=c(46)+pp(120)*q(1)
    pp(45)=c(45)+pp(119)*q(1)
    pp(44)=c(44)+pp(118)*q(1)
    pp(43)=c(43)+pp(126)*q(3)+pp(82)*q(1)
    pp(42)=c(42)+pp(125)*q(3)+pp(81)*q(1)
    pp(41)=c(41)+pp(107)*q(1)
    pp(40)=c(40)+pp(123)*q(3)+pp(80)*q(1)
    pp(39)=c(39)+pp(105)*q(1)
    pp(38)=c(38)+pp(103)*q(1)
    pp(37)=c(37)+pp(102)*q(1)
    pp(36)=c(36)+pp(101)*q(1)
    pp(35)=c(35)+pp(100)*q(1)
    pp(34)=c(34)+pp(83)*q(3)+pp(78)*q(1)+pp(56)*(-1.d0)+pp(55)*(-1.d0)+pp(54)*(-1.d0)
    pp(33)=c(33)+pp(90)*q(1)
    pp(32)=c(32)+pp(88)*q(1)
    pp(31)=c(31)+pp(87)*q(1)
    pp(30)=c(30)+pp(86)*q(1)
    pp(29)=c(29)+pp(85)*q(3)+pp(76)*q(1)
    pp(28)=c(28)+pp(79)*q(1)
    pp(27)=c(27)+pp(77)*q(1)
    qp(27)=qp(38)*q(3)
    qp(26)=qp(41)*q(3)+pp(73)*q(1)
    qp(25)=qp(40)*q(3)+pp(70)*q(1)
    qp(24)=qp(39)*q(3)+pp(66)*q(1)
    qp(23)=pp(152)*q(5)+pp(151)*q(4)+pp(68)*q(3)+qp(27)*(-1.d0)
    qp(22)=pp(150)*q(4)+qp(29)*q(3)+pp(58)*q(1)+qp(27)*(-1.d0)
    qp(21)=pp(67)*q(3)+pp(57)*q(1)+qp(27)*(-1.d0)
    qp(20)=pp(147)*q(5)+pp(146)*q(4)+qp(34)*q(2)+pp(65)*q(3)
    qp(19)=pp(145)*q(6)+pp(143)*q(4)+qp(33)*q(2)+qp(28)*q(3)+pp(53)*q(1)
    qp(18)=pp(144)*q(6)+pp(141)*q(5)+qp(32)*q(2)+pp(64)*q(3)+pp(51)*q(1)
    pp(26)=c(26)+pp(75)*q(3)+pp(46)*q(1)
    qp(17)=qp(31)*q(3)+pp(45)*q(1)
    pp(25)=c(25)+pp(74)*q(3)+pp(44)*q(1)
    pp(24)=c(24)+pp(69)*q(1)
    pp(23)=c(23)+pp(72)*q(3)+pp(41)*q(1)
    qp(16)=qp(30)*q(3)+pp(39)*q(1)
    pp(22)=c(22)+pp(71)*q(3)+pp(38)*q(1)
    pp(21)=c(21)+pp(63)*q(1)
    pp(20)=c(20)+pp(62)*q(1)
    pp(19)=c(19)+pp(137)*q(4)+pp(43)*q(3)+pp(33)*q(1)+qp(21)*(-1.d0)
    pp(18)=c(18)+pp(42)*q(3)+pp(32)*q(1)+qp(22)*(-1.d0)
    pp(17)=c(17)+pp(40)*q(3)+pp(31)*q(1)+qp(23)*(-1.d0)
    pp(16)=c(16)+pp(52)*q(1)
    pp(15)=c(15)+pp(50)*q(1)
    pp(14)=c(14)+pp(49)*q(1)
    pp(13)=c(13)+pp(48)*q(1)
    pp(12)=c(12)+pp(47)*q(3)+pp(28)*q(1)
    pp(11)=c(11)+pp(37)*q(1)
    pp(10)=c(10)+pp(36)*q(1)
    pp(9)=c(9)+pp(35)*q(1)
    pp(8)=c(8)+pp(99)*q(8)+pp(95)*q(6)+pp(93)*q(5)+pp(91)*q(4)+pp(34)*q(2)+&
    pp(29)*q(3)+pp(27)*q(1)+qp(20)*(-2.d0)+qp(19)*(-2.d0)+qp(18)*(-2.d0)
    pp(7)=c(7)+pp(30)*q(1)
    qp(15)=qp(37)*q(6)+qp(36)*q(5)+qp(35)*q(4)+qp(27)*q(2)+qp(24)*q(3)
    qp(14)=qp(26)*q(3)+pp(24)*q(1)
    qp(13)=qp(25)*q(3)+pp(21)*q(1)
    qp(12)=pp(61)*q(5)+pp(60)*q(4)+pp(23)*q(3)+qp(15)*(-1.d0)
    qp(11)=pp(59)*q(4)+qp(16)*q(3)+pp(16)*q(1)+qp(15)*(-1.d0)
    qp(10)=pp(22)*q(3)+pp(15)*q(1)+qp(15)*(-1.d0)
    pp(6)=c(6)+pp(26)*q(3)+pp(11)*q(1)
    qp(9)=qp(17)*q(3)+pp(10)*q(1)
    pp(5)=c(5)+pp(25)*q(3)+pp(9)*q(1)
    pp(4)=c(4)+pp(20)*q(1)
    pp(3)=c(3)+pp(56)*q(6)+pp(55)*q(5)+pp(54)*q(4)+pp(12)*q(3)+pp(7)*q(1)+&
    qp(12)*(-1.d0)+qp(11)*(-1.d0)+qp(10)*(-1.d0)
    pp(2)=c(2)+pp(14)*q(1)
    pp(1)=c(1)+pp(13)*q(1)
    qp(8)=pp(99)*p(8)+qp(23)*q(6)+qp(22)*q(5)+qp(21)*q(4)+qp(15)*q(2)+qp(13)*q(3)
    qp(7)=qp(14)*q(3)+pp(4)*q(1)
    qp(6)=pp(145)*q(19)+pp(144)*q(18)+pp(95)*p(8)+qp(37)*q(15)+pp(56)*p(3)+&
     qp(23)*q(8)+qp(20)*2*q(6)+pp(19)*q(5)+pp(18)*q(4)+qp(12)*q(2)+pp(6)*q(3)+&
    qp(8)*(-2.d0)
    qp(5)=pp(152)*q(23)+pp(147)*q(20)+pp(141)*q(18)+pp(93)*p(8)+qp(36)*q(15)+&
     pp(61)*q(12)+pp(55)*p(3)+qp(22)*q(8)+qp(19)*2*q(5)+pp(19)*q(6)+pp(17)*q(4)+&
    qp(11)*q(2)+qp(9)*q(3)+pp(2)*q(1)+qp(8)*(-2.d0)
    qp(4)=pp(151)*q(23)+pp(150)*q(22)+pp(146)*q(20)+pp(143)*q(19)+pp(137)*p(19)+&
     pp(91)*p(8)+qp(35)*q(15)+pp(60)*q(12)+pp(59)*q(11)+pp(54)*p(3)+qp(21)*q(8)+&
    qp(18)*2*q(4)+pp(18)*q(6)+pp(17)*q(5)+qp(10)*q(2)+pp(5)*q(3)+pp(1)*q(1)+qp(8)*(-2.d0)
    qp(3)=pp(174)*p(75)+pp(173)*p(74)+pp(171)*p(72)+pp(170)*p(71)+pp(167)*p(68)+&
     pp(166)*p(67)+pp(164)*p(65)+pp(163)*p(64)+pp(160)*q(37)+pp(159)*q(35)+pp(157)*q(34)+&
     pp(156)*q(32)+pp(130)*p(47)+pp(126)*p(43)+pp(125)*p(42)+pp(123)*p(40)+pp(117)*p(61)+&
     pp(116)*p(60)+pp(114)*p(59)+pp(111)*p(56)+pp(109)*p(55)+pp(108)*p(54)+pp(85)*p(29)+&
     pp(83)*p(34)+qp(41)*q(26)+qp(40)*q(25)+qp(39)*q(24)+qp(38)*q(27)+pp(75)*p(26)+&
     qp(31)*q(17)+pp(74)*p(25)+pp(72)*p(23)+qp(30)*q(16)+pp(71)*p(22)+pp(68)*q(23)+&
     qp(29)*q(22)+pp(67)*q(21)+pp(65)*q(20)+qp(28)*q(19)+pp(64)*q(18)+pp(47)*p(12)+&
     pp(43)*p(19)+pp(42)*p(18)+pp(40)*p(17)+pp(29)*p(8)+qp(26)*q(14)+qp(25)*q(13)+&
     qp(24)*q(15)+pp(26)*p(6)+qp(17)*q(9)+pp(25)*p(5)+pp(23)*q(12)+qp(16)*q(11)+&
     pp(22)*q(10)+pp(12)*p(3)+qp(14)*q(7)+qp(13)*q(8)+pp(6)*q(6)+qp(9)*q(5)+pp(5)*q(4)+&
    qp(7)*q(2)
    qp(2)=qp(34)*q(20)+qp(33)*q(19)+qp(32)*q(18)+pp(34)*p(8)+qp(27)*q(15)+&
    qp(15)*q(8)+qp(12)*q(6)+qp(11)*q(5)+qp(10)*q(4)+qp(8)*2*q(2)+qp(7)*q(3)
    qp(1)=pp(172)*q(41)+pp(169)*q(40)+pp(168)*p(73)+pp(165)*q(39)+pp(162)*p(70)+&
     pp(161)*p(69)+pp(158)*q(38)+pp(155)*p(66)+pp(154)*p(63)+pp(153)*p(62)+pp(149)*q(36)+&
     pp(148)*q(35)+pp(142)*q(33)+pp(140)*p(58)+pp(139)*q(32)+pp(138)*p(57)+pp(136)*p(53)+&
     pp(135)*p(52)+pp(134)*p(51)+pp(133)*p(50)+pp(132)*p(49)+pp(131)*p(48)+pp(129)*p(75)+&
     pp(128)*q(31)+pp(127)*p(74)+pp(124)*p(72)+pp(122)*q(30)+pp(121)*p(71)+pp(120)*p(46)+&
     pp(119)*p(45)+pp(118)*p(44)+pp(115)*p(68)+pp(113)*q(29)+pp(112)*p(67)+pp(110)*p(65)+&
     pp(107)*p(41)+pp(106)*q(28)+pp(105)*p(39)+pp(104)*p(64)+pp(103)*p(38)+pp(102)*p(37)+&
     pp(101)*p(36)+pp(100)*p(35)+pp(98)*p(61)+pp(97)*p(60)+pp(96)*p(59)+pp(94)*p(56)+&
     pp(92)*p(55)+pp(90)*p(33)+pp(89)*p(54)+pp(88)*p(32)+pp(87)*p(31)+pp(86)*p(30)+&
     pp(84)*p(47)+pp(82)*p(43)+pp(81)*p(42)+pp(80)*p(40)+pp(79)*p(28)+pp(78)*p(34)+&
     pp(77)*p(27)+pp(76)*p(29)+pp(73)*q(26)+pp(70)*q(25)+pp(69)*p(24)+pp(66)*q(24)+&
     pp(63)*p(21)+pp(62)*p(20)+pp(58)*q(22)+pp(57)*q(21)+pp(53)*q(19)+pp(52)*p(16)+&
     pp(51)*q(18)+pp(50)*p(15)+pp(49)*p(14)+pp(48)*p(13)+pp(46)*p(26)+pp(45)*q(17)+&
     pp(44)*p(25)+pp(41)*p(23)+pp(39)*q(16)+pp(38)*p(22)+pp(37)*p(11)+pp(36)*p(10)+&
     pp(35)*p(9)+pp(33)*p(19)+pp(32)*p(18)+pp(31)*p(17)+pp(30)*p(7)+pp(28)*p(12)+&
     pp(27)*p(8)+pp(24)*q(14)+pp(21)*q(13)+pp(20)*p(4)+pp(16)*q(11)+pp(15)*q(10)+&
     pp(14)*p(2)+pp(13)*p(1)+pp(11)*p(6)+pp(10)*q(9)+pp(9)*p(5)+pp(7)*p(3)+pp(4)*q(7)+&
    pp(2)*q(5)+pp(1)*q(4)
    mp(17)=pp(8)
    mp(16)=pp(3)+mp(17)*m(2)
    mp(15)=pp(3)
    mp(14)=pp(3)
    mp(13)=pp(3)
    mp(12)=qp(6)+mp(16)*m(3)+mp(15)*m(2)
    mp(11)=qp(6)
    mp(10)=qp(5)+mp(14)*m(2)
    mp(9)=qp(5)
    mp(8)=qp(4)
    mp(7)=qp(4)+mp(13)*m(2)
    mp(6)=qp(3)
    mp(5)=qp(2)+mp(12)*m(4)+mp(10)*m(3)+mp(8)*m(2)
    mp(4)=qp(2)+mp(12)*m(5)+mp(9)*m(2)+mp(7)*m(3)
    mp(3)=qp(2)+mp(16)*m(12)+mp(11)*m(2)+mp(10)*m(5)+mp(7)*m(4)
    mp(2)=qp(2)+mp(17)*m(16)+mp(15)*m(12)+mp(14)*m(10)+mp(13)*m(7)+mp(11)*m(3)+&
    mp(9)*m(4)+mp(8)*m(5)
    mp(1)=qp(1)
    xxp(1)=mp(6)*(-m(6)/a)*drdx22(1,1,xyz,r)+mp(5)*(-m(5)/a)*drdx22(1,2,xyz,r)+&
    mp(4)*(-m(4)/a)*drdx22(1,3,xyz,r)
    xxp(2)=mp(6)*(-m(6)/a)*drdx22(2,1,xyz,r)+mp(5)*(-m(5)/a)*drdx22(2,2,xyz,r)+&
    mp(4)*(-m(4)/a)*drdx22(2,3,xyz,r)
    xxp(3)=mp(6)*(-m(6)/a)*drdx22(3,1,xyz,r)+mp(5)*(-m(5)/a)*drdx22(3,2,xyz,r)+&
    mp(4)*(-m(4)/a)*drdx22(3,3,xyz,r)
    xxp(4)=mp(6)*(-m(6)/a)*drdx22(4,1,xyz,r)+mp(3)*(-m(3)/a)*drdx22(4,4,xyz,r)+&
    mp(2)*(-m(2)/a)*drdx22(4,5,xyz,r)
    xxp(5)=mp(6)*(-m(6)/a)*drdx22(5,1,xyz,r)+mp(3)*(-m(3)/a)*drdx22(5,4,xyz,r)+&
    mp(2)*(-m(2)/a)*drdx22(5,5,xyz,r)
    xxp(6)=mp(6)*(-m(6)/a)*drdx22(6,1,xyz,r)+mp(3)*(-m(3)/a)*drdx22(6,4,xyz,r)+&
    mp(2)*(-m(2)/a)*drdx22(6,5,xyz,r)
    xxp(7)=mp(5)*(-m(5)/a)*drdx22(7,2,xyz,r)+mp(3)*(-m(3)/a)*drdx22(7,4,xyz,r)+&
    mp(1)*(-m(1)/a)*drdx22(7,6,xyz,r)
    xxp(8)=mp(5)*(-m(5)/a)*drdx22(8,2,xyz,r)+mp(3)*(-m(3)/a)*drdx22(8,4,xyz,r)+&
    mp(1)*(-m(1)/a)*drdx22(8,6,xyz,r)
    xxp(9)=mp(5)*(-m(5)/a)*drdx22(9,2,xyz,r)+mp(3)*(-m(3)/a)*drdx22(9,4,xyz,r)+&
    mp(1)*(-m(1)/a)*drdx22(9,6,xyz,r)
    xxp(10)=mp(4)*(-m(4)/a)*drdx22(10,3,xyz,r)+mp(2)*(-m(2)/a)*drdx22(10,5,xyz,r)+&
    mp(1)*(-m(1)/a)*drdx22(10,6,xyz,r)
    xxp(11)=mp(4)*(-m(4)/a)*drdx22(11,3,xyz,r)+mp(2)*(-m(2)/a)*drdx22(11,5,xyz,r)+&
    mp(1)*(-m(1)/a)*drdx22(11,6,xyz,r)
    xxp(12)=mp(4)*(-m(4)/a)*drdx22(12,3,xyz,r)+mp(2)*(-m(2)/a)*drdx22(12,5,xyz,r)+&
    mp(1)*(-m(1)/a)*drdx22(12,6,xyz,r)

    return
  end subroutine deriv_rev22

end module bemsa22
